server:
  port: 8888
spring:
  application:
    name: aiDemo2
  
  # Redis 配置：用于会话存储
  data:
    redis:
      # Redis 服务器地址
      host: localhost
      # Redis 端口
      port: 6379
      # 数据库索引（0-15），默认使用 0
      database: 0
      # 连接超时时间（毫秒）
      timeout: 3000ms
      # Lettuce 连接池配置
      lettuce:
        pool:
          # 最大连接数（负数表示无限制）
          max-active: 8
          # 最大空闲连接数
          max-idle: 8
          # 最小空闲连接数
          min-idle: 2
          # 连接池最大阻塞等待时间（负数表示无限制）
          max-wait: -1ms
  
  # PostgreSQL Configuration
  datasource:
    url: jdbc:postgresql://localhost:5432/aidemo?stringtype=unspecified
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver

  ai:
    vectorstore:
      pgvector:
        index-type: HNSW
        # 维度需要和 embedding model 匹配，通义千问 text-embedding-v1 模型的维度是 1536
        dimension: 1536 
        distance-type: COSINE
        initialize-schema: true
        remove-existing-vector-store-table: false
    dashscope:
      api-key: sk-9542ddc0ec1e40c0a4f1b0d3d389e778
      chat:
        options:
          model: qwen-max
      embedding:
        options:
          # 指定使用阿里云通义千问的文本向量化模型
          model: text-embedding-v1

# MyBatis Plus 配置
mybatis-plus:
  # 指定 Type Handler 扫描包，确保我们自定义的 JsonbTypeHandler 被加载
  type-handlers-package: org.zerolg.aidemo2.handler
  configuration:
    # 开启驼峰命名转换
    map-underscore-to-camel-case: true
    # 配置日志实现
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      # 逻辑删除配置
      logic-delete-field: isDeleted # 全局逻辑删除的实体字段名
      logic-delete-value: 1 # 逻辑已删除值(默认为 1)
      logic-not-delete-value: 0 # 逻辑未删除值(默认为 0)

# 会话记忆配置
session:
  memory:
    # 会话 TTL（秒），默认 7 天
    ttl: 604800
    # 最大消息数量（超过后自动清理旧消息）
    max-messages: 100
    # 最大 token 预算（用于滑动窗口）
    max-prompt-tokens: 4000
    # 默认返回最近消息数量
    default-recent-count: 10
logging: 
  charset: 
    console: UTF-8 
    file: UTF-8
